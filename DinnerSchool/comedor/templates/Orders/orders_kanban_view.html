{% extends "main.html" %} {% load static %}{% block content %}
<div
  class="bg-white p-8 rounded-lg shadow-xl max-w-6xl w-full border-t-8 border-primary-red mb-8"
>
  <div class="flex flex-col md:flex-row items-center justify-between mb-6">
    <!-- Logo de la cafetería -->
    <div class="flex items-center mb-4 md:mb-0">
      <img
        src="{% static 'img/logos/logo.png' %}"
        alt="Logo de la Cafetería Certo"
        class="w-16 h-16 rounded-full border-2 border-primary-red p-1 object-cover mr-4"
      />
      <h1 class="text-3xl font-bold text-gray-800">Gestión de Pedidos</h1>
    </div>
    <!-- Botón para volver -->
    <div class="text-right">
      <a
        href="/core/dashboard"
        class="px-4 py-2 text-sm font-medium text-white bg-gray-600 rounded-md hover:bg-gray-700 transition duration-300 ease-in-out"
      >
        Volver
      </a>
    </div>
  </div>

  <!-- Contenedor del tablero Kanban -->
  <div class="flex flex-col md:flex-row gap-6 justify-center">
    <!-- Columna: Pendiente -->
    <div
      id="pendiente-column"
      class="kanban-column flex-1 bg-gray-100 p-4 rounded-lg shadow-custom min-w-[250px]"
      ondragover="allowDrop(event)"
      ondrop="drop(event)"
      ondragleave="dragLeave(event)"
    >
      <h2 class="text-xl font-semibold text-gray-800 mb-4 text-center">
        Pendiente
      </h2>
      <div id="pendiente-cards" class="space-y-4 min-h-[100px]">
        {% for order in orders %} {% if order.status == 'pendiente' %}
        <div
          id="{{ order.id }}"
          class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 cursor-grab active:cursor-grabbing"
          draggable="{{ user.is_employee|yesno:'true,false' }}"
        >
          <h3 class="font-bold text-gray-900 mb-1">{{ order.platillo }}</h3>
          <p class="text-sm text-gray-600">
            {% if order.is_profesor %}
            <strong>Profesor:</strong> {{ order.alumno }} {% else %}
            <strong>Alumno:</strong> {{ order.alumno }} {% endif %}
          </p>
          <p class="text-xs text-gray-500">
            {% if order.is_profesor%}
            <strong>Turno:</strong> {{ order.turno }} {% else %}
            <strong>Nivel:</strong> {{ order.nivel }} |
            <strong>Turno:</strong> {{ order.turno }} {% endif%}
          </p>
          {% if order.ingredientes %}
          <p class="text-xs text-gray-500">
            <strong>Ingredientes:</strong> {{ order.ingredientes }}
          </p>
          {% endif %} {% if order.nota %}
          <p class="text-xs text-gray-500">
            <strong>Nota:</strong> {{ order.nota }}
          </p>
          {% endif %} {% if order.encargado %}
          <p class="text-xs text-gray-500">
            <strong>Encargado:</strong> {{ order.encargado }}
          </p>
          {% endif %}
        </div>
        {% endif %} {% endfor %}
      </div>
    </div>

    <!-- Columna: En Preparación -->
    <div
      id="en-preparacion-column"
      class="kanban-column flex-1 bg-yellow-100 p-4 rounded-lg shadow-custom min-w-[250px]"
      ondragover="allowDrop(event)"
      ondrop="drop(event)"
      ondragleave="dragLeave(event)"
    >
      <h2 class="text-xl font-semibold text-gray-800 mb-4 text-center">
        En Preparación
      </h2>
      <div id="en-preparacion-cards" class="space-y-4 min-h-[100px]">
        {% for order in orders %} {% if order.status == 'en preparacion' %}
        <div
          id="{{ order.id }}"
          class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 cursor-grab active:cursor-grabbing"
          draggable="{{ user.is_employee|yesno:'true,false' }}"
        >
          <h3 class="font-bold text-gray-900 mb-1">{{ order.platillo }}</h3>
          {% if order.alumno %}
          <p class="text-sm text-gray-600">
            <strong>Alumno:</strong> {{ order.alumno }}
          </p>
          <p class="text-xs text-gray-500">
            <strong>Nivel:</strong> {{ order.nivel }} |
            <strong>Turno:</strong> {{ order.turno }}
          </p>
          {% endif %} {% if order.profesor%}
          <p class="text-sm text-gray-600">
            <strong>Profesor:</strong> {{ order.profesor }}
          </p>
          {% endif %} {% if order.responsable %}
          <p class="text-xs text-gray-500">
            <strong>Responsable:</strong>
          </p>
          {% endif %} {% if order.ingredientes %}
          <p class="text-xs text-gray-500">
            <strong>Ingredientes:</strong> {{ order.ingredientes }}
          </p>
          {% endif %} {% if order.nota %}
          <p class="text-xs text-gray-500">
            <strong>Nota:</strong> {{ order.nota }}
          </p>
          {% endif %}
        </div>
        {% endif %} {% endfor %}
      </div>
    </div>

    <!-- Columna: Finalizado -->
    <div
      id="finalizado-column"
      class="kanban-column flex-1 bg-blue-100 p-4 rounded-lg shadow-custom min-w-[250px]"
      ondragover="allowDrop(event)"
      ondrop="drop(event)"
      ondragleave="dragLeave(event)"
    >
      <h2 class="text-xl font-semibold text-gray-800 mb-4 text-center">
        Finalizado
      </h2>
      <div id="finalizado-cards" class="space-y-4 min-h-[100px]">
        {% for order in orders %} {% if order.status == 'finalizado' %}
        <div
          id="{{ order.id }}"
          class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 cursor-grab active:cursor-grabbing opacity-80"
          draggable="{{ user.is_employee|yesno:'true,false' }}"
        >
          <h3 class="font-bold text-gray-900 mb-1">{{ order.platillo }}</h3>
          {% if order.alumno %}
          <p class="text-sm text-gray-600">
            <strong>Alumno:</strong> {{ order.alumno }}
          </p>
          <p class="text-xs text-gray-500">
            <strong>Nivel:</strong> {{ order.nivel }} |
            <strong>Turno:</strong> {{ order.turno }}
          </p>
          {% endif %} {% if order.profesor%}
          <p class="text-sm text-gray-600">
            <strong>Profesor:</strong> {{ order.profesor }}
          </p>
          {% endif %} {% if order.responsable %}
          <p class="text-xs text-gray-500">
            <strong>Responsable:</strong>
          </p>
          {% endif %} {% if order.ingredientes %}
          <p class="text-xs text-gray-500">
            <strong>Ingredientes:</strong> {{ order.ingredientes }}
          </p>
          {% endif %} {% if order.nota %}
          <p class="text-xs text-gray-500">
            <strong>Nota:</strong> {{ order.nota }}
          </p>
          {% endif %}
        </div>
        {% endif %} {% endfor %}
      </div>
    </div>

    <!-- Columna: Entregado -->
    <div
      id="entregado-column"
      class="kanban-column flex-1 bg-green-100 p-4 rounded-lg shadow-custom min-w-[250px]"
      ondragover="allowDrop(event)"
      ondrop="drop(event)"
      ondragleave="dragLeave(event)"
    >
      <h2 class="text-xl font-semibold text-gray-800 mb-4 text-center">
        Entregado
      </h2>
      <div id="entregado-cards" class="space-y-4 min-h-[100px]">
        {% for order in orders %} {% if order.status == 'entregado' %}
        <div
          id="{{ order.id }}"
          class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 cursor-grab active:cursor-grabbing opacity-80"
          draggable="{{ user.is_employee|yesno:'true,false' }}"
        >
          <h3 class="font-bold text-gray-900 mb-1">{{ order.platillo }}</h3>
          {% if order.alumno %}
          <p class="text-sm text-gray-600">
            <strong>Alumno:</strong> {{ order.alumno }}
          </p>
          <p class="text-xs text-gray-500">
            <strong>Nivel:</strong> {{ order.nivel }} |
            <strong>Turno:</strong> {{ order.turno }}
          </p>
          {% endif %} {% if order.profesor%}
          <p class="text-sm text-gray-600">
            <strong>Profesor:</strong> {{ order.profesor }}
          </p>
          {% endif %} {% if order.responsable %}
          <p class="text-xs text-gray-500">
            <strong>Responsable:</strong>
          </p>
          {% endif %} {% if order.ingredientes %}
          <p class="text-xs text-gray-500">
            <strong>Ingredientes:</strong> {{ order.ingredientes }}
          </p>
          {% endif %} {% if order.nota %}
          <p class="text-xs text-gray-500">
            <strong>Nota:</strong> {{ order.nota }}
          </p>
          {% endif %}
        </div>
        {% endif %} {% endfor %}
      </div>
    </div>
  </div>
</div>

<script src="{% static 'js/kanban.js' %}"></script>
{% endblock %}
